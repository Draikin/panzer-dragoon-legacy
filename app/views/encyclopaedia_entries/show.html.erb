<% title @encyclopaedia_entry.name %>
<% description truncated_text(@encyclopaedia_entry.content) %>

<% if !@encyclopaedia_entry.publish %>
  <span class="label label-warning">Unpublished</span>
<% elsif !@encyclopaedia_entry.category.publish %>
  <span class="label label-warning">Published in Unpublished Category</span>
<% end %>

<% if policy(EncyclopaediaEntry).new? ||
  policy(@encyclopaedia_entry).edit? ||
  policy(@encyclopaedia_entry).destroy? %>
  <div class="btn-group" role="group">
    <% if policy(EncyclopaediaEntry).new? %>
      <%= link_to 'New Encyclopaedia Entry',
        new_encyclopaedia_entry_path(category: @encyclopaedia_entry.category),
        { class: 'btn btn-secondary', role: 'button' }
      %>
    <% end %>
    <% if policy(@encyclopaedia_entry).edit? %>
      <%= link_to 'Edit Encyclopaedia Entry',
        edit_encyclopaedia_entry_path(@encyclopaedia_entry),
        { class: 'btn btn-secondary', role: 'button' }
      %>
    <% end %>
    <% if policy(@encyclopaedia_entry).destroy? %>
      <%= link_to 'Delete Encyclopaedia Entry',
        @encyclopaedia_entry,
        data: {
          confirm: 'Are you sure you want to delete this encyclopaedia entry?'
        },
        method: :delete,
        class: 'btn btn-danger',
        role: 'button'
      %>
    <% end %>
  </div>
<% end %>

<%= render partial: 'information',
  locals: { encyclopaedia_entry: @encyclopaedia_entry }
%>

<%= raw illustrated_markdown_to_html @encyclopaedia_entry.id,
  "EncyclopaediaEntry", @encyclopaedia_entry.content %>

<% unless @articles.count == 0 %>
  <%= render partial: 'related_articles', locals: { articles: @articles } %>
<% end %>
<% unless @downloads.count == 0 %>
  <%= render partial: 'related_downloads', locals: { downloads: @downloads } %>
<% end %>
<% unless @links.count == 0 %>
  <%= render partial: 'related_links', locals: { links: @links } %>
<% end %>
<% unless @music_tracks.count == 0 %>
  <%= render partial: 'related_music_tracks',
    locals: { music_tracks: @music_tracks }
  %>
<% end %>
<% unless @pictures.count == 0 %>
  <%= render partial: 'related_pictures', locals: { pictures: @pictures } %>
<% end %>
<% unless @poems.count == 0 %>
  <%= render partial: 'related_poems', locals: { poems: @poems } %>
<% end %>
<% unless @quizzes.count == 0 %>
  <%= render partial: 'related_quizzes', locals: { quizzes: @quizzes } %>
<% end %>
<% unless @resources.count == 0 %>
  <%= render partial: 'related_resources', locals: { resources: @resources } %>
<% end %>
<% unless @stories.count == 0 %>
  <%= render partial: 'related_stories', locals: { stories: @stories } %>
<% end %>
<% unless @videos.count == 0 %>
  <%= render partial: 'related_videos', locals: { videos: @videos } %>
<% end %>

<ol class="breadcrumb">
  <li><%= link_to 'Home', root_url %></li>
  <li><%= link_to 'Encyclopaedia', encyclopaedia_entries_path %></li>
  <li>
    <%= link_to @encyclopaedia_entry.category.name,
      category_path(@encyclopaedia_entry.category)
    %>
  </li>
  <li class="active"><%= @encyclopaedia_entry.name %></li>
</ol>
