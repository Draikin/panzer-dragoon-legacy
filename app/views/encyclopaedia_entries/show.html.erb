<% title @encyclopaedia_entry.name %>
<% description truncated_text(@encyclopaedia_entry.content) %>

<% if !@encyclopaedia_entry.publish %>
  <p class="unpublished">Unpublished</p>
<% elsif !@encyclopaedia_entry.category.publish %>
  <p class="unpublished">Published in Unpublished Category</p>
<% end %>

<% if policy(@encyclopaedia_entry).new? or policy(@encyclopaedia_entry).edit? or
  policy(@encyclopaedia_entry).destroy? %>
  <div class="ui three item stackable menu">
    <% if policy(@encyclopaedia_entry).new? %>
      <%= link_to new_encyclopaedia_entry_path(
        category: @encyclopaedia_entry.category), class: 'item' do %>
        <i class="write icon"></i> New Encyclopaedia Entry
      <% end %>
    <% end %>
    <% if policy(@encyclopaedia_entry).edit? %>
      <%= link_to edit_encyclopaedia_entry_path(@encyclopaedia_entry), 
        class: 'item' do %>
        <i class="edit icon"></i> Edit Encyclopaedia Entry
      <% end %>
    <% end %>
    <% if policy(@encyclopaedia_entry).destroy? %>
      <%= link_to @encyclopaedia_entry, data: {
        confirm: 'Are you sure you want to delete this encyclopaedia entry?' },
        method: :delete, class: 'item' do %>
        <i class="trash icon"></i> Delete Encyclopaedia Entry
      <% end %>
    <% end %>
  </div>
<% end %>

<div id="information">
  <% if @encyclopaedia_entry.encyclopaedia_entry_picture_file_name.blank? %>
    <%= image_tag("default-encyclopaedia-entry-picture-embedded.jpg",
      alt: "Sorry No Image", width: "280", height: "280") %><br />
  <% else %>
    <%= encyclopaedia_entry_picture_tag @encyclopaedia_entry, :embedded %><br />
  <% end %>
  <%= raw markdown_to_html @encyclopaedia_entry.information %>
</div>

<%= raw illustrated_markdown_to_html @encyclopaedia_entry.id,
  "EncyclopaediaEntry", @encyclopaedia_entry.content %>

<% unless @articles.count == 0 %>
  <h2>Related Articles</h2>
  <ul>
    <% @articles.each do |article| %>
      <li>
        <%= link_to article.name, article %>
        <% if !article.publish %>
           - <span class="unpublished">Unpublished</span>
        <% elsif !article.category.publish %>
           - <span class="unpublished">Published in Unpublished Category</span>
        <% end %>
      </li>
    <% end %>
  </ul>
<% end %>
<% unless @downloads.count == 0 %>
  <h2>Related Downloads</h2>
  <ul>
    <% @downloads.each do |download| %>
      <li>
        <%= link_to download.name, download %>
        <% if !download.publish %>
           - <span class="unpublished">Unpublished</span>
        <% elsif !download.category.publish %>
           - <span class="unpublished">Published in Unpublished Category</span>
        <% end %>
      </li>
    <% end %>
  </ul>
<% end %>
<% unless @links.count == 0 %>
  <h2>Related Links</h2>
  <ul>
    <% @links.each do |link| %>
      <li><%= link_to link.name, link.url %></li>
    <% end %>
  </ul>
<% end %>
<% unless @music_tracks.count == 0 %>
  <h2>Related Music</h2>
  <ul>
    <% @music_tracks.each do |music_track| %>
      <li>
        <%= link_to music_track.name, music_track %>
        <% if !music_track.publish %>
           - <span class="unpublished">Unpublished</span>
        <% elsif !music_track.category.publish %>
           - <span class="unpublished">Published in Unpublished Category</span>
        <% end %>
      </li>
    <% end %>
  </ul>
<% end %>
<% unless @pictures.count == 0 %>
  <h2>Related Pictures</h2>
  <div id="related_pictures">
    <% @pictures.each do |picture| %>
      <%= link_to image_tag(picture.picture.url(:mini_thumbnail),
        alt: picture.name, width: "75", height: "75"), picture %>
    <% end %>
  </div>
<% end %>
<% unless @poems.count == 0 %>
  <h2>Related Poems</h2>
  <ul>
    <% @poems.each do |poem| %>
      <li>
        <%= link_to poem.name, poem %>
        <% unless poem.publish %>
           - <span class="unpublished">Unpublished</span>
        <% end %>
      </li>
    <% end %>
  </ul>
<% end %>
<% unless @quizzes.count == 0 %>
  <h2>Related Quizzes</h2>
  <ul>
    <% @quizzes.each do |quiz| %>
      <li>
        <%= link_to quiz.name, quiz %>
        <% unless quiz.publish %>
           - <span class="unpublished">Unpublished</span>
        <% end %>
      </li>
    <% end %>
  </ul>
<% end %>
<% unless @resources.count == 0 %>
  <h2>Related Resources</h2>
  <ul>
    <% @resources.each do |resource| %>
      <li>
        <%= link_to resource.name, resource %>
        <% if !resource.publish %>
           - <span class="unpublished">Unpublished</span>
        <% elsif !resource.category.publish %>
           - <span class="unpublished">Published in Unpublished Category</span>
        <% end %>
      </li>
    <% end %>
  </ul>
<% end %>
<% unless @stories.count == 0 %>
  <h2>Related Stories</h2>
  <ul>
    <% @stories.each do |story| %>
      <li>
        <%= link_to story.name, story %>
        <% if !story.publish %>
           - <span class="unpublished">Unpublished</span>
        <% elsif !story.category.publish %>
           - <span class="unpublished">Published in Unpublished Category</span>
        <% end %>
      </li>
    <% end %>
  </ul>
<% end %>
<% unless @videos.count == 0 %>
  <h2>Related Videos</h2>
  <ul>
    <% @videos.each do |video| %>
      <li>
        <%= link_to video.name, video %>
        <% if !video.publish %>
           - <span class="unpublished">Unpublished</span>
        <% elsif !video.category.publish %>
           - <span class="unpublished">Published in Unpublished Category</span>
        <% end %>
      </li>
    <% end %>
  </ul>
<% end %>

<p class="links">
  <%= link_to 'Encyclopaedia', encyclopaedia_entries_path %> |
  <%= link_to @encyclopaedia_entry.category.name,
    category_path(@encyclopaedia_entry.category) %>
</p>
