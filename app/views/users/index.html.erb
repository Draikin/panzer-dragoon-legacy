<% title "Users" %>

<p>
  Admins cannot create users. Users must be registered when not already logged
  in as another user. To register, first <%= link_to "Log Out", 
  destroy_user_session_path, method: :delete %>, then load the 
  <%= link_to "Register", new_user_registration_path %> page.
</p>

<% if @users %>
  <div id="resources">
    <% @users.each do |user| %>
      <div class="resource">
        <div class="details">
          <h2><%= user.email %></h2>
          <dl>
            <% if user.contributor_profile %>
              <dt>Contributor Profile</dt>
              <dd>
                <%= link_to user.contributor_profile.name, 
                  contributor_profile_path(user.contributor_profile) %>
              </dd>
            <% end %>
            <dt>Administrator?</dt>
            <dd><%= user.administrator ? "Yes" : "No" %></dd>
            <dt>Confirmed?</dt>
            <dd><%= user.confirmed_at.present? ? "Yes" : "No" %></dd>
            <dt>Locked?</dt>
            <dd><%= user.locked_at.present? ? "Yes" : "No" %></dd>
          </dl>
          <% if policy(user).edit? and policy(user).destroy? %>
            <ul class="administration">
              <li><%= link_to 'Edit User', edit_user_path(user) %></li>
              <li>
                <%= link_to 'Delete User', user, data: {
                  confirm: 'Are you sure?' }, method: :delete %>
              </li>
            </ul>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
  <%= paginate @users %>
<% end %>
