<% if @contributor_profile %>
  <% title "#{@contributor_profile.name}'s News Entries" %>
<% elsif params[:filter] == 'draft' %>
  <% title "Draft News Entries" %>
<% elsif policy(NewsEntry).new? %>
  <% title "News Entries" %>
<% end %>

<% if policy(NewsEntry).new? %>
  <ul class="administration">
    <li><%= link_to 'New News Entry', new_news_entry_path %></li>
  </ul>
<% end %>

<% if @news_entries %>
  <% @news_entries.each do |news_entry| %>
    <div class="resource">
      <h1><%= link_to news_entry.name, news_entry %></h1>
      <%= show_news_entry_picture(news_entry, :embedded) %>
      <div class="comment_thumbnail">
        <% if news_entry.contributor_profile.avatar_file_name.blank? %>
          <%= image_tag("default-avatar.jpg") %>
        <% else %>
          <%=
            image_tag(
              news_entry.contributor_profile.avatar.url(:thumbnail)
            )
          %>
          <br />
        <% end %>
      </div>
      <div class="comment_details">
        <p>
          <% if news_entry.publish %>
            Published by
          <% else %>
            Posted by
          <% end %>
          <%= link_to news_entry.contributor_profile.name,
            news_entry.contributor_profile
          %>
          <% if news_entry.publish %>
            <%= local_time_ago news_entry.published_at %>.
          <% else %>
            - <span class="unpublished">Unpublished</span>
          <% end %>
        </p>
        <%= raw news_entry_markdown_to_html news_entry.content %>
      </div>
    </div>
  <% end %>
  <%= paginate @news_entries %>
<% end %>
