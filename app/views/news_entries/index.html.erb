<% if @contributor_profile %>
  <% title "#{@contributor_profile.name}'s News Entries" %>
<% elsif params[:filter] == 'draft' %>
  <% title "Draft News Entries" %>
<% else %>
  <% title "Latest News" %>
<% end %>

<p>
  <%= link_to "Sign the petition for a rerelease of the Panzer Dragoon games!",
    "http://www.panzerdragoonrevival.com" %>
</p>

<% if policy(NewsEntry).new? %>
  <%= link_to new_news_entry_path,
    { class: 'btn btn-secondary', role: 'button' } do %>
    <%= fa_icon 'pencil' %> New News Entry
  <% end %>
<% end %>

<% if @news_entries %>
  <ul class="media-list">
    <% @news_entries.each do |news_entry| %>
      <li class="media">
        <div class="media-left">
          <% if news_entry.contributor_profile.avatar_file_name.blank? %>
            <%= image_tag("default-avatar.jpg") %>
          <% else %>
            <%= image_tag news_entry.contributor_profile.avatar.url(
                :thumbnail
              )
            %>
          <% end %>
        </div>
        <div class="media-body">
          <h2><%= link_to news_entry.name, news_entry %></h2>
          <p>
            <% if news_entry.publish %>
              Published by
            <% else %>
              Posted by
            <% end %>
            <%= link_to news_entry.contributor_profile.name,
              news_entry.contributor_profile
            %>
            <% if news_entry.publish %>
              <%= local_time_ago news_entry.published_at %>.
            <% else %>
              <span class="label label-warning">Unpublished</span>
            <% end %>
          </p>
          <%= raw news_entry_markdown_to_html news_entry.content %>
        </div>
      </li>
    <% end %>
  </ul>
  <%= paginate @news_entries %>
<% end %>
