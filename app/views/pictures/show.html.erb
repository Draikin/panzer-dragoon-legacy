<% title @picture.name %>
<% description @picture.description %>

<% if !@picture.publish %>
  <p class="unpublished">
    This picture is not published. Please inform an administrator when it and
    the associated news entry are ready to be published.
  </p>
<% elsif !@picture.category.publish %>
  <p class="unpublished">Published in Unpublished Category</p>
<% end %>
<% if !@picture.publish || !@picture.category.publish %>
  <p class="unpublished">
    Use this Markdown to embed the picture in a news entry:
    <code>![](<%= @picture.id %>-<%= @picture.url %>.jpg)</code>
  </p>
<% end %>

<%
  if (
    policy(@picture).new? ||
    policy(@picture).edit? ||
    policy(@picture).destroy?
  )
%>
  <ul class="administration">
    <% if policy(Album).new? %>
      <li>
        <%=
          link_to(
            'New Album',
            new_album_path(category: @picture.category)
          )
        %>
      </li>
    <% end %>
    <% if policy(@picture).new? %>
      <li>
        <%=
          link_to(
            'New Picture',
            new_picture_path(category: @picture.category)
          )
        %>
      </li>
    <% end %>
    <% if @picture.album %>
      <% if policy(@picture.album).edit? %>
        <li>
          <%= link_to "Edit Picture's Album", edit_album_path(@picture.album) %>
        </li>
      <% end %>
    <% end %>
    <% if policy(@picture).edit? %>
      <li>
        <%= link_to 'Edit Picture', edit_picture_path(@picture) %>
      </li>
    <% end %>
    <% if policy(@picture).destroy? %>
      <li>
        <%=
          link_to(
            'Delete Picture',
            @picture,
            data: { confirm: 'Are you sure you want to delete this picture?' },
            method: :delete
          )
        %>
      </li>
    <% end %>
  </ul>
<% end %>

<% if @picture_to_replace %>
  <h2>Picture to Replace:</h2>
  <%=
    link_to(
      picture_tag(@picture_to_replace, :thumbnail),
      @picture_to_replace
    )
  %>
  <p class="unpublished">
    <%= @picture_to_replace.name_and_id %> will be replaced when
    <%= @picture.name_and_id %> is published.
  </p>
<% end %>

<h2>Contributed By:</h2>
<ul class="thumbnail_and_name_list">
  <% @picture.contributor_profiles.each do |contributor_profile| %>
    <li>
      <%=
        link_to(
          show_avatar(contributor_profile, :mini_thumbnail),
          contributor_profile
        )
      %>
      <h3><%= link_to contributor_profile.name, contributor_profile %></h3>
    </li>
  <% end %>
</ul>

<div class="embedded_picture_container">
  <%= link_to picture_tag(@picture, :embedded), @picture.picture.url %>
</div>

<p><%= link_to "View Full Size", @picture.picture.url %></p>

<p><%= @picture.description %></p>

<% unless @picture.information.blank? %>
  <%= raw markdown_to_html @picture.information %>
<% end %>

<% if @other_pictures_in_album %>
  <% unless @other_pictures_in_album.count == 0 %>
    <h2>Other Pictures in this Album</h2>
    <div id="other_pictures_in_album">
      <% @other_pictures_in_album.each do |picture| %>
        <%=
          link_to(
            image_tag(
              picture.picture.url(:mini_thumbnail),
              alt: picture.name,
              width: '75',
              height: '75'
            ),
            picture
          )
        %>
      <% end %>
    </div>
  <% end %>
<% end %>

<%= render partial: 'shared/related_encyclopaedia_entries' %>

<p class="links">
  <%= link_to 'Pictures', pictures_path %> |
  <%= link_to @picture.category.name, category_path(@picture.category) %>
</p>
