<% title @music_track.name %>
<% description @music_track.description %>

<% if !@music_track.publish %>
  <span class="label label-warning">Unpublished</span>
<% elsif !@music_track.category.publish %>
  <span class="label label-warning">Published in Unpublished Category</span>
<% end %>

<% if policy(MusicTrack).new? ||
  policy(@music_track).edit? ||
  policy(@music_track).destroy?
%>
  <div class="btn-group" role="group">
    <% if policy(MusicTrack).new? %>
      <%= link_to new_music_track_path(category: @music_track.category),
        { class: 'btn btn-secondary', role: 'button' } do %>
        <%= fa_icon 'upload' %> New Music Track
      <% end %>
    <% end %>
    <% if policy(@music_track).edit? %>
      <%= link_to edit_music_track_path(@music_track),
        { class: 'btn btn-secondary', role: 'button' } do %>
        <%= fa_icon 'edit' %> Edit Music Track
      <% end %>
    <% end %>
    <% if policy(@music_track).destroy? %>
      <%= link_to @music_track,
        data: { confirm: 'Are you sure you want to delete this music track?' },
        method: :delete,
        class: 'btn btn-danger',
        role: 'button' do %>
        <%= fa_icon 'trash' %> Delete Music Track
      <% end %>
    <% end %>
  </div>
<% end %>

<h2>Contributed By:</h2>
<ul>
  <% @music_track.contributor_profiles.each do |contributor_profile| %>
    <li><%= link_to contributor_profile.name, contributor_profile %></li>
  <% end %>
</ul>

<audio controls="true" autobuffer="true">
  <source type="audio/mp3" src="<%= @music_track.mp3_music_track.url %>" />
  <source type="audio/ogg" src="<%= @music_track.ogg_music_track.url %>" />
  Your browser does not support the <code>audio</code> element.
</audio>

<p><%= @music_track.description %></p>

<% unless @music_track.information.blank? %>
  <%= raw markdown_to_html @music_track.information %>
<% end %>

<p>
  <% unless @music_track.track_number == 0 %>
    Track <%= @music_track.track_number.to_s %> of
    <%= @music_track.category.music_tracks.count %>.
  <% end %>
  Download Music Track: <%= link_to "MP3", @music_track.mp3_music_track.url %>
  | <%= link_to "Ogg Vorbis", @music_track.ogg_music_track.url %>
  <% if @music_track.flac_music_track.present? %>
     | <%= link_to "FLAC", @music_track.flac_music_track.url %>
  <% end %>
</p>

<%= render 'shared/show/related_encyclopaedia_entries' %>

<ol class="breadcrumb">
  <li><%= link_to 'Home', root_url %></li>
  <li><%= link_to 'Music', music_tracks_path %></li>
  <li><%= link_to @music_track.category.name,
    category_path(@music_track.category) %></li>
  <li class="active"><%= @music_track.name %></li>
</ol>
